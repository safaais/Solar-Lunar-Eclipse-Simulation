<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar & Lunar Eclipse Simulation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(ellipse at center, #0d1529 0%, #050d1a 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
            overflow: hidden;
            height: 100vh;
        }
        
        #canvas {
            display: block;
            background: linear-gradient(45deg, #0a0f1c 25%, #1a1f2e 25%, #1a1f2e 50%, #0a0f1c 50%, #0a0f1c 75%, #1a1f2e 75%);
            background-size: 40px 40px;
        }
        
        .controls-panel {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #333;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        
        .controls-title {
            text-align: center;
            margin: 0 0 15px 0;
            color: #ffd700;
            font-size: 18px;
            font-weight: bold;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .control-btn {
            padding: 12px 18px;
            background: linear-gradient(145deg, #2a3040, #1a2030);
            border: 2px solid #444;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 120px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border-color: #666;
        }
        
        .control-btn.active {
            background: linear-gradient(145deg, #ff6b35, #f7931e);
            border-color: #ff8c42;
            box-shadow: 0 0 25px rgba(255, 107, 53, 0.6);
            color: white;
        }
        
        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 25px 35px;
            border-radius: 15px;
            border: 2px solid #333;
            text-align: center;
            max-width: 600px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        }
        
        .info-title {
            margin: 0 0 12px 0;
            color: #ffd700;
            font-size: 26px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        .info-description {
            margin: 0;
            font-size: 16px;
            line-height: 1.6;
            color: #e0e0e0;
        }
        
        .legend-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #333;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.7);
            min-width: 200px;
        }
        
        .legend-title {
            margin: 0 0 15px 0;
            color: #ffd700;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 12px 0;
            gap: 12px;
        }
        
        .legend-sphere {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }
        
        .sun-sphere {
            background: radial-gradient(circle at 30% 30%, #ffff44, #ffa500);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: sunGlow 2s ease-in-out infinite alternate;
        }
        
        .earth-sphere {
            background: radial-gradient(circle at 30% 30%, #4169e1, #1e90ff);
            box-shadow: 0 0 10px rgba(65, 105, 225, 0.5);
        }
        
        .moon-sphere {
            background: radial-gradient(circle at 30% 30%, #f8f8f8, #c0c0c0);
            box-shadow: 0 0 8px rgba(192, 192, 192, 0.4);
        }
        
        @keyframes sunGlow {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
            100% { box-shadow: 0 0 30px rgba(255, 215, 0, 1); }
        }
        
        .keyboard-hints {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            border: 1px solid #444;
            line-height: 1.5;
        }
        
        .performance-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 18px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: 1px solid #444;
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¸Ù„Ø§Ù„ ÙˆØ§Ù„ØªÙˆÙ‡Ø¬ */
        .shadow-effect {
            filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.8));
        }
        
        .glow-effect {
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6));
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div class="controls-panel">
        <div class="controls-title">ğŸŒŒ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©</div>
        <div class="controls-grid">
            <button class="control-btn active" onclick="setMode('normal')">
                ğŸŒ Ø§Ù„Ù…Ø¯Ø§Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ<br><small>(N)</small>
            </button>
            <button class="control-btn" onclick="setMode('eclipse')">
                ğŸŒ‘ ÙƒØ³ÙˆÙ Ø§Ù„Ø´Ù…Ø³<br><small>(E)</small>
            </button>
            <button class="control-btn" onclick="setMode('lunar')">
                ğŸŒ• Ø®Ø³ÙˆÙ Ø§Ù„Ù‚Ù…Ø±<br><small>(L)</small>
            </button>
        </div>
    </div>
    
    <div class="keyboard-hints">
        <strong>âŒ¨ï¸ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯:</strong><br>
        <kbd>N</kbd> - Ø§Ù„Ù…Ø¯Ø§Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ<br>
        <kbd>E</kbd> - ÙƒØ³ÙˆÙ Ø§Ù„Ø´Ù…Ø³<br>
        <kbd>L</kbd> - Ø®Ø³ÙˆÙ Ø§Ù„Ù‚Ù…Ø±<br>
        <kbd>ESC</kbd> - Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©
    </div>
    
    <div class="performance-info" id="performance">
        FPS: 60 | Ø§Ù„Ø£Ø±Ø¶: 0Â° | Ø§Ù„Ù‚Ù…Ø±: 0Â°
    </div>
    
    <div class="legend-panel">
        <div class="legend-title">ğŸª Ø§Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ©</div>
        <div class="legend-item">
            <div class="legend-sphere sun-sphere"></div>
            <span>Ø§Ù„Ø´Ù…Ø³ (Ù…ØµØ¯Ø± Ø§Ù„Ø¶ÙˆØ¡)</span>
        </div>
        <div class="legend-item">
            <div class="legend-sphere earth-sphere"></div>
            <span>Ø§Ù„Ø£Ø±Ø¶</span>
        </div>
        <div class="legend-item">
            <div class="legend-sphere moon-sphere"></div>
            <span>Ø§Ù„Ù‚Ù…Ø±</span>
        </div>
    </div>
    
    <div class="info-panel">
        <div class="info-title" id="mode-title">ğŸŒ Ø§Ù„Ù…Ø¯Ø§Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ</div>
        <div class="info-description" id="mode-description">
            Ø§Ù„Ø£Ø±Ø¶ ØªØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø´Ù…Ø³ ÙÙŠ Ù…Ø¯Ø§Ø± Ø¯Ø§Ø¦Ø±ÙŠ ÙˆØ§Ù„Ù‚Ù…Ø± ÙŠØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø£Ø±Ø¶ ÙÙŠ Ù…Ø¯Ø§Ø±Ù‡ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ.
            Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ù„Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ© ÙÙŠ Ù†Ø¸Ø§Ù…Ù†Ø§ Ø§Ù„Ø´Ù…Ø³ÙŠ.
        </div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ ÙˆØ§Ù„Ø³ÙŠØ§Ù‚
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
        let earthOrbitAngle = 0.0;
        let moonOrbitAngle = 0.0;
        let eclipseMode = false;
        let lunarEclipseMode = false;
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
        let frameCount = 0;
        let lastTime = performance.now();
        let fps = 60;
        
        // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
        const modeInfo = {
            normal: {
                title: 'ğŸŒ Ø§Ù„Ù…Ø¯Ø§Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ',
                description: 'Ø§Ù„Ø£Ø±Ø¶ ØªØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø´Ù…Ø³ ÙÙŠ Ù…Ø¯Ø§Ø± Ø¯Ø§Ø¦Ø±ÙŠ ÙˆØ§Ù„Ù‚Ù…Ø± ÙŠØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø£Ø±Ø¶ ÙÙŠ Ù…Ø¯Ø§Ø±Ù‡ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ. Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ù„Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ© ÙÙŠ Ù†Ø¸Ø§Ù…Ù†Ø§ Ø§Ù„Ø´Ù…Ø³ÙŠ.'
            },
            eclipse: {
                title: 'ğŸŒ‘ ÙƒØ³ÙˆÙ Ø§Ù„Ø´Ù…Ø³',
                description: 'Ø§Ù„Ù‚Ù…Ø± ÙŠÙ…Ø± Ø¨ÙŠÙ† Ø§Ù„Ø£Ø±Ø¶ ÙˆØ§Ù„Ø´Ù…Ø³ Ù…Ø­Ø¬Ø¨Ø§Ù‹ Ø¶ÙˆØ¡ Ø§Ù„Ø´Ù…Ø³ Ø¹Ù† Ø§Ù„Ø£Ø±Ø¶. Ù‡Ø°Ù‡ Ø¸Ø§Ù‡Ø±Ø© Ø§Ù„ÙƒØ³ÙˆÙ Ø§Ù„Ø´Ù…Ø³ÙŠ Ø§Ù„Ù†Ø§Ø¯Ø±Ø© Ø§Ù„ØªÙŠ ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ØªØµØ·Ù Ø§Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ© ÙÙŠ Ø®Ø· Ù…Ø³ØªÙ‚ÙŠÙ….'
            },
            lunar: {
                title: 'ğŸŒ• Ø®Ø³ÙˆÙ Ø§Ù„Ù‚Ù…Ø±',
                description: 'Ø§Ù„Ø£Ø±Ø¶ ØªÙ…Ø± Ø¨ÙŠÙ† Ø§Ù„Ø´Ù…Ø³ ÙˆØ§Ù„Ù‚Ù…Ø± ÙØªØ­Ø¬Ø¨ Ø¶ÙˆØ¡ Ø§Ù„Ø´Ù…Ø³ Ø¹Ù† Ø§Ù„Ù‚Ù…Ø±. Ù‡Ø°Ù‡ Ø¸Ø§Ù‡Ø±Ø© Ø§Ù„Ø®Ø³ÙˆÙ Ø§Ù„Ù‚Ù…Ø±ÙŠ Ø§Ù„ØªÙŠ ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¯Ø®Ù„ Ø§Ù„Ù‚Ù…Ø± ÙÙŠ Ø¸Ù„ Ø§Ù„Ø£Ø±Ø¶.'
            }
        };
        
        // Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹
        function setMode(mode) {
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
            eclipseMode = false;
            lunarEclipseMode = false;
            
            // Ø¶Ø¨Ø· Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            if (mode === 'eclipse') {
                eclipseMode = true;
            } else if (mode === 'lunar') {
                lunarEclipseMode = true;
            }
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('mode-title').textContent = modeInfo[mode].title;
            document.getElementById('mode-description').textContent = modeInfo[mode].description;
        }
        
        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… ÙƒØ±Ø© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù…Ø¹ Ø¥Ø¶Ø§Ø¡Ø©
        function drawSphere(position, radius, color, isLightSource = false) {
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
            const perspective = 800;
            const z = position.z + 400; // Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù‚
            const scale = perspective / z;
            
            const screenX = position.x * scale + canvas.width / 2;
            const screenY = position.y * scale + canvas.height / 2;
            const screenRadius = radius * scale;
            
            // Ø±Ø³Ù… Ø§Ù„ØªÙˆÙ‡Ø¬ Ù„Ù„Ø´Ù…Ø³
            if (isLightSource) {
                const glowGradient = ctx.createRadialGradient(screenX, screenY, 0, screenX, screenY, screenRadius * 4);
                glowGradient.addColorStop(0, 'rgba(255, 215, 0, 0.8)');
                glowGradient.addColorStop(0.2, 'rgba(255, 165, 0, 0.6)');
                glowGradient.addColorStop(0.5, 'rgba(255, 69, 0, 0.3)');
                glowGradient.addColorStop(1, 'transparent');
                
                ctx.fillStyle = glowGradient;
                ctx.beginPath();
                ctx.arc(screenX, screenY, screenRadius * 4, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Ø±Ø³Ù… Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ø¹ ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ
            const gradient = ctx.createRadialGradient(
                screenX - screenRadius * 0.3, 
                screenY - screenRadius * 0.3, 
                0,
                screenX, 
                screenY, 
                screenRadius
            );
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¬Ø±Ù…
            switch(color) {
                case 'sun':
                    gradient.addColorStop(0, '#FFFF66');
                    gradient.addColorStop(0.7, '#FFD700');
                    gradient.addColorStop(1, '#FF8C00');
                    break;
                case 'earth':
                    gradient.addColorStop(0, '#87CEEB');
                    gradient.addColorStop(0.4, '#4169E1');
                    gradient.addColorStop(1, '#1E3A8A');
                    break;
                case 'moon':
                    gradient.addColorStop(0, '#FFFFFF');
                    gradient.addColorStop(0.6, '#F5F5F5');
                    gradient.addColorStop(1, '#A0A0A0');
                    break;
            }
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(screenX, screenY, screenRadius, 0, 2 * Math.PI);
            ctx.fill();
            
            // Ø±Ø³Ù… Ø§Ù„Ø­Ø¯ÙˆØ¯
            ctx.strokeStyle = isLightSource ? 'rgba(255, 255, 0, 0.8)' : 'rgba(255, 255, 255, 0.4)';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            return { x: screenX, y: screenY, radius: screenRadius };
        }
        
        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ù…Ø¯Ø§Ø±Ø§Øª
        function drawOrbit(center, radius) {
            const perspective = 800;
            const z = center.z + 400;
            const scale = perspective / z;
            
            const screenX = center.x * scale + canvas.width / 2;
            const screenY = center.y * scale + canvas.height / 2;
            const screenRadius = radius * scale;
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.arc(screenX, screenY, screenRadius, 0, 2 * Math.PI);
            ctx.stroke();
            ctx.setLineDash([]);
        }
        
        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ø¸Ù„Ø§Ù„
        function drawShadow(lightPos, objectPos, shadowLength = 400) {
            const dx = objectPos.x - lightPos.x;
            const dy = objectPos.y - lightPos.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                const shadowEndX = objectPos.x + (dx / distance) * shadowLength;
                const shadowEndY = objectPos.y + (dy / distance) * shadowLength;
                
                const shadowGradient = ctx.createLinearGradient(
                    objectPos.x, objectPos.y, 
                    shadowEndX, shadowEndY
                );
                shadowGradient.addColorStop(0, 'rgba(0, 0, 0, 0.9)');
                shadowGradient.addColorStop(0.7, 'rgba(0, 0, 0, 0.3)');
                shadowGradient.addColorStop(1, 'transparent');
                
                ctx.strokeStyle = shadowGradient;
                ctx.lineWidth = objectPos.radius * 2.5;
                ctx.lineCap = 'round';
                ctx.beginPath();
                ctx.moveTo(objectPos.x, objectPos.y);
                ctx.lineTo(shadowEndX, shadowEndY);
                ctx.stroke();
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø®Ø·ÙˆØ· Ø§Ù„Ø§ØªØµØ§Ù„
        function drawAlignmentLines(sun, earth, moon) {
            ctx.strokeStyle = 'rgba(255, 255, 100, 0.5)';
            ctx.lineWidth = 3;
            ctx.setLineDash([8, 8]);
            
            ctx.beginPath();
            ctx.moveTo(sun.x, sun.y);
            ctx.lineTo(earth.x, earth.y);
            ctx.lineTo(moon.x, moon.y);
            ctx.stroke();
            ctx.setLineDash([]);
        }
        
        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
        function updatePerformance(currentTime) {
            frameCount++;
            if (currentTime - lastTime >= 1000) {
                fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
                frameCount = 0;
                lastTime = currentTime;
                
                document.getElementById('performance').textContent = 
                    `FPS: ${fps} | Ø§Ù„Ø£Ø±Ø¶: ${Math.round(earthOrbitAngle)}Â° | Ø§Ù„Ù‚Ù…Ø±: ${Math.round(moonOrbitAngle)}Â°`;
            }
        }
        
        // Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø±Ø³Ù… (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
        function animate(currentTime) {
            updatePerformance(currentTime);
            
            // Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Ø´Ø©
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Ù…ÙˆØ§Ø¶Ø¹ Ø§Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ© (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
            const sunPosition = { x: -200, y: 0, z: 0 };
            
            const earthPosition = {
                x: Math.cos(earthOrbitAngle * Math.PI / 180) * 280,
                y: 0,
                z: Math.sin(earthOrbitAngle * Math.PI / 180) * 280
            };
            
            let moonPosition;
            
            if (eclipseMode) {
                // Ø§Ù„Ù‚Ù…Ø± Ø¨ÙŠÙ† Ø§Ù„Ø£Ø±Ø¶ ÙˆØ§Ù„Ø´Ù…Ø³ (ÙƒØ³ÙˆÙ)
                moonPosition = {
                    x: (earthPosition.x + sunPosition.x) / 2,
                    y: 0,
                    z: (earthPosition.z + sunPosition.z) / 2
                };
            } else if (lunarEclipseMode) {
                // Ø§Ù„Ø£Ø±Ø¶ Ø¨ÙŠÙ† Ø§Ù„Ø´Ù…Ø³ ÙˆØ§Ù„Ù‚Ù…Ø± (Ø®Ø³ÙˆÙ)
                moonPosition = {
                    x: earthPosition.x + (earthPosition.x - sunPosition.x),
                    y: 0,
                    z: earthPosition.z + (earthPosition.z - sunPosition.z)
                };
            } else {
                // Ø§Ù„Ù…Ø¯Ø§Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ù„Ù„Ù‚Ù…Ø± Ø­ÙˆÙ„ Ø§Ù„Ø£Ø±Ø¶
                moonPosition = {
                    x: earthPosition.x + Math.cos(moonOrbitAngle * Math.PI / 180) * 100,
                    y: 0,
                    z: earthPosition.z + Math.sin(moonOrbitAngle * Math.PI / 180) * 100
                };
            }
            
            // Ø±Ø³Ù… Ø§Ù„Ù…Ø¯Ø§Ø±Ø§Øª
            drawOrbit({ x: 0, y: 0, z: 0 }, 280);
            drawOrbit(earthPosition, 100);
            
            // Ø±Ø³Ù… Ø§Ù„Ø£Ø¬Ø±Ø§Ù… Ø§Ù„Ø³Ù…Ø§ÙˆÙŠØ©
            const sunRendered = drawSphere(sunPosition, 60, 'sun', true);
            const earthRendered = drawSphere(earthPosition, 40, 'earth');
            const moonRendered = drawSphere(moonPosition, 12, 'moon');
            
            // Ø±Ø³Ù… Ø§Ù„Ø¸Ù„Ø§Ù„ ÙˆØ§Ù„Ø®Ø·ÙˆØ· ÙÙŠ Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„ÙƒØ³ÙˆÙ
            if (eclipseMode) {
                drawShadow(sunRendered, earthRendered, 300);
                drawAlignmentLines(sunRendered, moonRendered, earthRendered);
            } else if (lunarEclipseMode) {
                drawShadow(sunRendered, moonRendered, 250);
                drawAlignmentLines(sunRendered, earthRendered, moonRendered);
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²ÙˆØ§ÙŠØ§ (Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
            earthOrbitAngle += 0.1;
            moonOrbitAngle += 0.3;
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ±Ø§ÙƒÙ…
            if (earthOrbitAngle >= 360) earthOrbitAngle = 0;
            if (moonOrbitAngle >= 360) moonOrbitAngle = 0;
            
            requestAnimationFrame(animate);
        }
        
        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯ (Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ)
        document.addEventListener('keydown', (e) => {
            const key = e.key.toLowerCase();
            
            if (key === 'escape') {
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©ØŸ')) {
                    document.body.innerHTML = `
                        <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background:#000;">
                            <h1 style="color:#ffd700;font-size:36px;margin-bottom:20px;">ğŸŒŒ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©</h1>
                            <p style="color:white;font-size:18px;">Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ÙƒØ³ÙˆÙ ÙˆØ§Ù„Ø®Ø³ÙˆÙ</p>
                        </div>
                    `;
                }
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
            if (key === 'n') {
                eclipseMode = false;
                lunarEclipseMode = false;
                updateUI('normal');
            } else if (key === 'e') {
                eclipseMode = true;
                lunarEclipseMode = false;
                updateUI('eclipse');
            } else if (key === 'l') {
                lunarEclipseMode = true;
                eclipseMode = false;
                updateUI('lunar');
            }
        });
        
        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateUI(mode) {
            document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.control-btn');
            switch(mode) {
                case 'normal': buttons[0].classList.add('active'); break;
                case 'eclipse': buttons[1].classList.add('active'); break;
                case 'lunar': buttons[2].classList.add('active'); break;
            }
            
            document.getElementById('mode-title').textContent = modeInfo[mode].title;
            document.getElementById('mode-description').textContent = modeInfo[mode].description;
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©
        animate(performance.now());
        
        // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
        console.log('ğŸŒŒ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ÙƒØ³ÙˆÙ ÙˆØ§Ù„Ø®Ø³ÙˆÙ');
        console.log('âŒ¨ï¸ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙØ§ØªÙŠØ­ N, E, L Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹');
        console.log('ğŸ® Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©');
    </script>
</body>
</html>